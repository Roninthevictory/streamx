<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <title>Streamx - Under Maintenance</title>
    <meta name="description" content="StreamX Movies - Site Under Maintenance">

    <link rel="apple-touch-icon" sizes="180x180" href="https://cdn.discordapp.com/attachments/1390972394138763304/1390972428238454784/ChatGPT_Image_Jul_5_2025_03_00_06_AM.png?ex=686a3385&is=6868e205&hm=af327a1fbe8f91dc6feb573cca3806cd794b2cfe67d76ed5ab1c0e10c0503ea3&">
    <link rel="icon" type="image/png" sizes="32x32" href="https://cdn.discordapp.com/attachments/1390972394138763304/1390972428238454784/ChatGPT_Image_Jul_5_2025_03_00_06_AM.png?ex=686a3385&is=6868e205&hm=af327a1fbe8f91dc6feb573cca3806cd794b2cfe67d76ed5ab1c0e10c0503ea3&">
    <link rel="icon" type="image/png" sizes="16x16" href="https://cdn.discordapp.com/attachments/1390972394138763304/1390972428238454784/ChatGPT_Image_Jul_5_2025_03_00_06_AM.png?ex=686a3385&is=6868e205&hm=af327a1fbe8f91dc6feb573cca3806cd794b2cfe67d76ed5ab1c0e10c0503ea3&">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="icon" href="https://cdn.discordapp.com/attachments/1390972394138763304/1390972428238454784/ChatGPT_Image_Jul_5_2025_03_00_06_AM.png?ex=686a3385&is=6868e205&hm=af327a1fbe8f91dc6feb573cca3806cd794b2cfe67d76ed5ab1c0e10c0503ea3&" type="image/x-icon" />

    <meta property="og:title" content="StreamX Movies - Under Maintenance">
    <meta property="og:description" content="StreamX Movies - Site Under Maintenance">
    <meta property="og:image" content="https://cdn.discordapp.com/attachments/1390972394138763304/1390972428238454784/ChatGPT_Image_Jul_5_2025_03_00_06_AM.png?ex=686a3385&is=6868e205&hm=af327a1fbe8f91dc6feb573cca3806cd794b2cfe67d76ed5ab1c0e10c0503ea3&">
    <meta property="og:url" content="https://streamx.rvoinc.com/">
    <meta property="og:type" content="website">

    <style>
        body {
            margin: 0;
            font-family: 'Inter', Arial, sans-serif; /* Changed to Inter for modern look */
            background-color: #111;
            color: #fff;
            display: flex;
            flex-direction: column;
            min-height: 100vh;
            justify-content: center; /* Center content vertically */
            align-items: center; /* Center content horizontally */
            text-align: center;
        }
        /* Hide all main content when in maintenance mode */
        #header, #authBar, #content, #adBanner, #errorMsg, #player, #playerError, #footer, #grandOpeningBanner {
            display: none !important; /* Use !important to override inline styles */
        }

        .maintenance-container {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            min-height: 100vh; /* Take full viewport height */
            width: 100%;
            padding: 20px;
            box-sizing: border-box;
        }

        .maintenance-box {
            background-color: #1a1a1a;
            border-radius: 15px; /* More rounded corners */
            padding: 40px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.6);
            max-width: 600px;
            width: 95%;
            border: 2px solid #00ccff; /* Accent border */
        }

        .maintenance-box h1 {
            color: #00ccff;
            font-size: 2.8em; /* Larger heading */
            margin-bottom: 20px;
            text-shadow: 0 0 10px rgba(0, 204, 255, 0.5); /* Subtle glow */
        }

        .maintenance-box p {
            font-size: 1.2em;
            line-height: 1.6;
            margin-bottom: 25px;
            color: #ccc;
        }

        .maintenance-box .icon {
            font-size: 4em; /* Large icon */
            color: #00ccff;
            margin-bottom: 20px;
            animation: pulse 2s infinite alternate; /* Simple pulse animation */
        }

        @keyframes pulse {
            from {
                transform: scale(1);
                opacity: 0.8;
            }
            to {
                transform: scale(1.05);
                opacity: 1;
            }
        }

        /* Responsive adjustments */
        @media (max-width: 600px) {
            .maintenance-box {
                padding: 25px;
            }
            .maintenance-box h1 {
                font-size: 2em;
            }
            .maintenance-box p {
                font-size: 1em;
            }
            .maintenance-box .icon {
                font-size: 3em;
            }
        }
    </style>
</head>
<body>
    <!-- Maintenance Message Container -->
    <div id="maintenanceMessage" class="maintenance-container">
        <div class="maintenance-box">
            <div class="icon">‚öôÔ∏è</div> <!-- Gear icon for maintenance -->
            <h1>Site Under Maintenance</h1>
            <p>We're currently performing essential updates to improve your StreamX experience. We apologize for any inconvenience.</p>
            <p>Please check back soon! We appreciate your patience.</p>
        </div>
    </div>

    <!-- Original content (hidden by CSS when maintenance mode is active) -->
    <header id="header">
        <h2>üé¨ StreamX</h2>
        <div id="navTabs">
            <nav>
                <a href="#home" data-media-type="movie" data-genre="">Home</a>
                <a href="#action" data-media-type="movie" data-genre="28">Action Movies</a>
                <a href="#comedy" data-media-type="movie" data-genre="35">Comedy Movies</a>
                <a href="#horror" data-media-type="movie" data-genre="27">Horror Movies</a>
                <a href="#scifi" data-media-type="movie" data-genre="878">Sci-Fi Movies</a>
                <a href="#tvshows" data-media-type="tv" data-genre="">TV Shows</a>
                <a href="#search">Search</a>
            </nav>
        </div>
        <div id="grandOpeningBanner">
            üéâ Welcome to <strong>StreamX</strong> Grand Opening! Join our <a href="https://discord.gg/v9tS43Hamm" target="_blank">Discord</a> for the <strong>3 Massive Giveaways</strong> over the next 6 weeks!
        </div>
    </header>

    <div id="authBar">
        Logged in as <span id="userEmail"></span> [<span id="userTierBadge"></span>]
        <button onclick="logout()" style="margin-left:10px; background:red; color:white;">Logout</button>
    </div>

    <div id="content"></div>

    <div id="adBanner">
        <p>üö® Ad: Enjoy ad-free by upgrading your pass! üéâ</p>
        <img src="https://via.placeholder.com/728x90?text=Your+Ad+Here" alt="Ad Banner">
    </div>

    <div id="errorMsg"></div>
    <iframe id="player" src="" allowfullscreen></iframe>
    <div id="playerError"></div>

    <footer id="footer">
        <button onclick="window.open('https://your-external-tos-link.com', '_blank', 'noopener')">Terms of Service</button>
        <button onclick="showDMCA()">DMCA Takedown</button>
        <button onclick="showAbout()">About StreamX</button>
    </footer>

    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database-compat.js"></script>

    <script>
        // --- Firebase Configuration ---
        const LOGIN_WEBHOOK_URL = "https://discord.com/api/webhooks/1391109624752767049/w1b1xlWTnGAjxZ3-kArs7kjWm-0Crpg4ZV__XQF3BeI65aLnN7ToP21EwXLGZ_CxMRT";

        function sendWebhookLog(action, userData = {}) {
            const time = new Date().toLocaleString();
            const {
                email = "Unknown",
                uid = "Unknown",
                tier = "Unknown"
            } = userData;

            const content = `üì• **${action.toUpperCase()} EVENT**\n**Email:** ${email}\n**UID:** \`${uid}\`\n**Tier:** ${tier}\n**Time:** ${time}`;

            fetch(LOGIN_WEBHOOK_URL, {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({ content })
            }).catch(err => console.error("Webhook error:", err));
        }

        const firebaseConfig = {
            apiKey: "AIzaSyCbMwMJKqLuAO7lUPUNh_5SiY5eXtPO-q4",
            authDomain: "streamx-b6e05.firebaseapp.com",
            databaseURL: "https://streamx-b6e05-default-rtdb.firebaseio.com",
            projectId: "streamx-b6e05",
            storageBucket: "streamx-b6e05.firebasestorage.app",
            messagingSenderId: "293739854404",
            appId: "1:293739854404:web:5013fb77841130bcd89a11"
        };

        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const database = firebase.database();

        // --- DOM Elements ---
        const content = document.getElementById("content");
        const player = document.getElementById("player");
        const errorMsg = document.getElementById("errorMsg");
        const playerError = document.getElementById("playerError");
        const navTabs = document.getElementById("navTabs"); // Get the navTabs div
        const authBar = document.getElementById("authBar"); // Get the authBar div
        const adBanner = document.getElementById("adBanner"); // Get the adBanner div
        const footer = document.getElementById("footer"); // Get the footer
        const header = document.getElementById("header"); // Get the header
        const grandOpeningBanner = document.getElementById("grandOpeningBanner"); // Get the grandOpeningBanner

        let playerTimeout; // For managing video playback timeout

        // --- TMDb API Configuration ---
        const TMDB_API_KEY = "2e7af0b444be53c66db2c4bfb069b286"; // <<<<<<<<<<<<<<<< REPLACE THIS WITH YOUR ACTUAL TMDB API KEY
        const TMDB_BASE_URL = "https://api.themoviedb.org/3";
        const TMDB_IMAGE_BASE_URL = "https://image.tmdb.org/t/p/w500"; // For movie/TV show posters
        const TMDB_BACKDROP_BASE_URL = "https://image.tmdb.org/t/p/w1280"; // For TV show backdrops

        // --- Maintenance Mode Flag ---
        const isMaintenanceMode = true; // Set to true to activate maintenance page

        // Function to toggle visibility of main content based on maintenance mode
        function toggleMainContentVisibility() {
            const mainContentElements = [
                header, navTabs, authBar, content, adBanner, errorMsg, player, playerError, footer, grandOpeningBanner
            ];
            const maintenanceMessage = document.getElementById("maintenanceMessage");

            if (isMaintenanceMode) {
                mainContentElements.forEach(el => {
                    if (el) el.style.display = 'none';
                });
                if (maintenanceMessage) maintenanceMessage.style.display = 'flex'; // Show maintenance message
            } else {
                // If not in maintenance mode, show original elements as per their default display or JS logic
                // This part of the code would be expanded if you wanted to switch modes dynamically
                // For now, we are just ensuring they are hidden if maintenance is true.
                if (maintenanceMessage) maintenanceMessage.style.display = 'none'; // Hide maintenance message
            }
        }

        // Call the toggle function on page load
        document.addEventListener('DOMContentLoaded', toggleMainContentVisibility);


        // --- Helper Functions ---
        function capitalize(str) {
            if (!str) return "";
            return str.charAt(0).toUpperCase() + str.slice(1);
        }

        function clearMessages() {
            clearTimeout(playerTimeout);
            player.style.display = "none";
            player.src = "";
            errorMsg.textContent = "";
            playerError.textContent = "";
        }

        // --- Core Content Loading Functions ---
        async function fetchMediaData(type, idOrQuery, isSearch = false) {
            if (isMaintenanceMode) return []; // Prevent fetching if in maintenance
            let url = '';
            if (isSearch) {
                url = `${TMDB_BASE_URL}/search/${type}?api_key=${TMDB_API_KEY}&query=${encodeURIComponent(idOrQuery)}`;
            } else if (idOrQuery) {
                url = `${TMDB_BASE_URL}/discover/${type}?api_key=${TMDB_API_KEY}&with_genres=${idOrQuery}&language=en-US&sort_by=popularity.desc&page=1`;
            } else {
                url = `${TMDB_BASE_URL}/${type}/popular?api_key=${TMDB_API_KEY}&language=en-US&page=1`;
            }

            try {
                const res = await fetch(url);
                if (!res.ok) {
                    throw new Error(`HTTP error! status: ${res.status}`);
                }
                const data = await res.json();
                return data.results;
            } catch (e) {
                console.error(`Fetch Error for ${type}:`, e);
                throw new Error(`Failed to load ${type} data. Please try again later.`);
            }
        }

        async function fetchTvShowDetails(tvId) {
            if (isMaintenanceMode) return null; // Prevent fetching if in maintenance
            try {
                const res = await fetch(`${TMDB_BASE_URL}/tv/${tvId}?api_key=${TMDB_API_KEY}&append_to_response=seasons&language=en-US`);
                if (!res.ok) {
                    throw new Error(`HTTP error! status: ${res.status}`);
                }
                const data = await res.json();
                return data;
            } catch (e) {
                console.error("Error fetching TV show details:", e);
                throw new Error("Failed to load TV show details.");
            }
        }

        async function fetchTvShowEpisodes(tvId, seasonNumber) {
            if (isMaintenanceMode) return []; // Prevent fetching if in maintenance
            try {
                const res = await fetch(`${TMDB_BASE_URL}/tv/${tvId}/season/${seasonNumber}?api_key=${TMDB_API_KEY}&language=en-US`);
                if (!res.ok) {
                    throw new Error(`HTTP error! status: ${res.status}`);
                }
                const data = await res.json();
                return data.episodes;
            } catch (e) {
                console.error("Error fetching TV show episodes:", e);
                throw new Error("Failed to load TV show episodes.");
            }
        }

        async function getImdbId(tmdbId, mediaType) {
            if (isMaintenanceMode) return null; // Prevent fetching if in maintenance
            try {
                const res = await fetch(`${TMDB_BASE_URL}/${mediaType}/${tmdbId}/external_ids?api_key=${TMDB_API_KEY}`);
                const data = await res.json();
                return data.imdb_id;
            } catch (e) {
                console.error("Error fetching IMDb ID:", e);
                return null;
            }
        }

        async function displayMediaGrid(mediaItems, mediaType, title = "") {
            if (isMaintenanceMode) return; // Do nothing if in maintenance
            clearMessages(); // Clear any existing messages or player

            if (!mediaItems || mediaItems.length === 0) {
                content.innerHTML = `<h1>${title || capitalize(mediaType)}</h1><div id="errorMsg">No content found.</div>`;
                return;
            }

            content.innerHTML = `<h1>${title || capitalize(mediaType)}</h1><div class="grid" id="mediaGrid"></div>`;
            const grid = document.getElementById("mediaGrid");

            for (const item of mediaItems.slice(0, 20)) { // Limit to 20 items for initial load
                if (!item.poster_path) continue;

                const div = document.createElement('div');
                div.className = 'movie'; // Keeping .movie class as it's styled similarly
                div.innerHTML = `
                    <img src="${TMDB_IMAGE_BASE_URL}${item.poster_path}" alt="${item.title || item.name}">
                    <div class="movie-title">${item.title || item.name}</div>
                `;

                if (mediaType === 'movie') {
                    const imdbId = await getImdbId(item.id, mediaType);
                    if (imdbId) {
                        div.onclick = () => playMedia('movie', imdbId, item.title || item.name);
                        grid.appendChild(div);
                    }
                } else if (mediaType === 'tv') {
                    div.onclick = () => displayTvShowDetails(item.id, item.name);
                    grid.appendChild(div);
                }
            }

            if (grid.children.length === 0 && mediaItems.length > 0) {
                errorMsg.textContent = `Could not find playable links for the displayed ${mediaType} content.`;
            } else if (grid.children.length === 0) {
                errorMsg.textContent = `No ${mediaType} content available.`;
            }
        }

        async function displayTvShowDetails(tvId, tvTitle) {
            if (isMaintenanceMode) return; // Do nothing if in maintenance
            clearMessages();
            content.innerHTML = `<div id="loader">Loading TV show details...</div>`;

            try {
                const tvShow = await fetchTvShowDetails(tvId);
                if (!tvShow) {
                    throw new Error("TV show details not found.");
                }

                content.innerHTML = `
                    <div class="tv-details">
                        <img src="${TMDB_IMAGE_BASE_URL}${tvShow.poster_path}" alt="${tvShow.name}">
                        <h2>${tvShow.name}</h2>
                        <p>${tvShow.overview}</p>
                        <div class="episode-selector">
                            <label for="seasonSelect">Select Season:</label>
                            <select id="seasonSelect"></select>
                            <label for="episodeSelect">Select Episode:</label>
                            <select id="episodeSelect"></select>
                            <div class="episode-description" id="episodeDescription">
                                <h3>Episode Description:</h3>
                                <p id="episodeDescText">Select an episode to see its description.</p>
                            </div>
                            <button onclick="playSelectedEpisode(${tvShow.id}, '${tvShow.name}')" style="margin-top: 20px; padding: 10px 20px; background-color: #00ccff; color: black; border: none; border-radius: 5px; cursor: pointer; font-weight: bold;">Play Episode</button>
                        </div>
                    </div>
                `;

                const seasonSelect = document.getElementById('seasonSelect');
                const episodeSelect = document.getElementById('episodeSelect');
                const episodeDescText = document.getElementById('episodeDescText');

                // Populate seasons
                tvShow.seasons.forEach(season => {
                    if (season.season_number > 0 && season.episode_count > 0) {
                        const option = document.createElement('option');
                        option.value = season.season_number;
                        option.textContent = `Season ${season.season_number}`;
                        seasonSelect.appendChild(option);
                    }
                });

                // Function to load episodes for the selected season
                const loadEpisodes = async () => {
                    episodeSelect.innerHTML = ''; // Clear previous episodes
                    episodeDescText.textContent = 'Select an episode to see its description.';
                    const selectedSeason = seasonSelect.value;
                    if (selectedSeason) {
                        const episodes = await fetchTvShowEpisodes(tvShow.id, selectedSeason);
                        episodes.forEach(episode => {
                            const option = document.createElement('option');
                            option.value = episode.episode_number;
                            option.textContent = `E${episode.episode_number}: ${episode.name}`;
                            option.dataset.overview = episode.overview || 'No description available.';
                            episodeSelect.appendChild(option);
                        });
                        if (episodes.length > 0) {
                            episodeDescText.textContent = episodes[0].overview || 'No description available.';
                        }
                    }
                };

                // Event listener for season change
                seasonSelect.addEventListener('change', loadEpisodes);

                // Event listener for episode change to update description
                episodeSelect.addEventListener('change', () => {
                    const selectedOption = episodeSelect.options[episodeSelect.selectedIndex];
                    episodeDescText.textContent = selectedOption.dataset.overview;
                });

                // Load episodes for the first season by default
                if (tvShow.seasons.length > 0) {
                    await loadEpisodes();
                }

            } catch (e) {
                console.error("Error displaying TV show details:", e);
                content.innerHTML = `<div id="errorMsg">${e.message}</div>`;
            }
        }


        function playMedia(mediaType, imdbID, mediaTitle, seasonNumber = null, episodeNumber = null) {
            if (isMaintenanceMode) return; // Do nothing if in maintenance
            clearMessages();
            if (!imdbID || !/^tt\d+$/.test(imdbID)) {
                errorMsg.textContent = "Invalid content ID, cannot load video.";
                return;
            }

            let embedUrl = '';
            if (mediaType === 'movie') {
                embedUrl = `https://vidsrc.to/embed/movie/${imdbID}`;
            } else if (mediaType === 'tv' && seasonNumber !== null && episodeNumber !== null) {
                embedUrl = `https://vidsrc.to/embed/tv/${imdbID}/${seasonNumber}/${episodeNumber}`;
            } else {
                errorMsg.textContent = "Invalid parameters for TV show playback.";
                return;
            }

            player.src = embedUrl;
            player.style.display = "block";
            // Scroll to player view
            window.scrollTo({ top: document.body.scrollHeight, behavior: 'smooth' });

            playerError.textContent = `Now attempting to play: ${mediaTitle}${mediaType === 'tv' ? ` S${seasonNumber} E${episodeNumber}` : ''}.`;
            // After a few seconds, show message if video might not be available
            playerTimeout = setTimeout(() => {
                playerError.textContent = `If "${mediaTitle}${mediaType === 'tv' ? ` S${seasonNumber} E${episodeNumber}` : ''}" failed to load, this content might not be available on VidSrc.`;
            }, 7000);
        }

        function playSelectedEpisode(tvId, tvTitle) {
            if (isMaintenanceMode) return; // Do nothing if in maintenance
            const seasonSelect = document.getElementById('seasonSelect');
            const episodeSelect = document.getElementById('episodeSelect');

            const selectedSeason = seasonSelect.value;
            const selectedEpisode = episodeSelect.value;

            if (selectedSeason && selectedEpisode) {
                getImdbId(tvId, 'tv').then(imdbId => {
                    if (imdbId) {
                        playMedia('tv', imdbId, tvTitle, selectedSeason, selectedEpisode);
                    } else {
                        playerError.textContent = "Could not find IMDb ID for this TV show to play.";
                    }
                }).catch(e => {
                    console.error("Error getting IMDb ID for TV show:", e);
                    playerError.textContent = "Error preparing TV show playback.";
                });
            } else {
                playerError.textContent = "Please select both a season and an episode.";
            }
        }


        async function showSearchContent() {
            if (isMaintenanceMode) return; // Do nothing if in maintenance
            content.innerHTML = `
                <h1>üîç Search StreamX</h1>
                <div class="search-box">
                    <input type="text" id="searchInput" placeholder="Search movies or TV shows..." />
                    <button onclick="performSearch()">Search</button>
                </div>
                <div class="grid" id="searchResults"></div>
            `;
            document.getElementById('searchInput').focus();
            document.getElementById('searchInput').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    performSearch();
                }
            });
        }

        async function performSearch() {
            if (isMaintenanceMode) return; // Do nothing if in maintenance
            clearMessages();
            const query = document.getElementById("searchInput").value.trim();
            const searchResultsDiv = document.getElementById("searchResults");

            if (!query) {
                searchResultsDiv.innerHTML = "";
                return;
            }
            searchResultsDiv.innerHTML = "<div id='loader'>Searching...</div>";

            try {
                const url = `${TMDB_BASE_URL}/search/multi?api_key=${TMDB_API_KEY}&query=${encodeURIComponent(query)}`;
                const res = await fetch(url);
                if (!res.ok) throw new Error('Network response was not ok.');
                const data = await res.json();

                searchResultsDiv.innerHTML = ""; // Clear loader
                const validResults = data.results.filter(item =>
                    (item.media_type === 'movie' || item.media_type === 'tv') && item.poster_path
                );

                if (validResults.length === 0) {
                    searchResultsDiv.innerHTML = "<div id='errorMsg'>No results found for that query.</div>";
                    return;
                }

                for (const item of validResults.slice(0, 20)) {
                    const mediaType = item.media_type; // 'movie' or 'tv'
                    const div = document.createElement("div");
                    div.className = "movie";
                    div.innerHTML = `
                        <img src="${TMDB_IMAGE_BASE_URL}${item.poster_path}" alt="${item.title || item.name}">
                        <div class="movie-title">${item.title || item.name} (${capitalize(mediaType)})</div>
                    `;

                    if (mediaType === 'movie') {
                        const imdbId = await getImdbId(item.id, mediaType);
                        if (imdbId) {
                            div.onclick = () => playMedia('movie', imdbId, item.title || item.name);
                            searchResultsDiv.appendChild(div);
                        }
                    } else if (mediaType === 'tv') {
                        // For TV shows, clicking on search result goes to TV show details page
                        div.onclick = () => displayTvShowDetails(item.id, item.name);
                        searchResultsDiv.appendChild(div);
                    }
                }
                if (searchResultsDiv.children.length === 0 && validResults.length > 0) {
                    searchResultsDiv.innerHTML = "<div id='errorMsg'>Could not find playable links for search results.</div>";
                } else if (searchResultsDiv.children.length === 0) {
                    searchResultsDiv.innerHTML = "<div id='errorMsg'>No results found.</div>";
                }

            } catch (e) {
                console.error("Search error:", e);
                searchResultsDiv.innerHTML = "<div id='errorMsg'>Failed to perform search. Try again.</div>";
            }
        }

        // --- Static Pages ---
        function showDMCA() {
            if (isMaintenanceMode) return; // Do nothing if in maintenance
            clearMessages();
            content.innerHTML = `
                <h1>DMCA Takedown Request</h1>
                <p>If you believe content on StreamX infringes your copyright, please submit a DMCA takedown request here.</p>
                <p>Email: <a href="mailto:dmca@streamx.com" target="_blank" rel="noopener noreferrer">dmca@streamx.com</a></p>
                <p>Include details such as:</p>
                <ul>
                    <li>Your contact information</li>
                    <li>Description of the copyrighted work</li>
                    <li>URL of infringing content</li>
                    <li>Statement of good faith belief</li>
                    <li>Signature</li>
                </ul>
            `;
        }

        function showAbout() {
            if (isMaintenanceMode) return; // Do nothing if in maintenance
            clearMessages();
            content.innerHTML = `
                <h1>About StreamX</h1>
                <p>StreamX is a free and premium movie and TV show streaming platform.</p>
                <p>Our mission is to provide users with a wide range of content in a user-friendly, ad-supported or ad-free environment depending on your subscription.</p>
                <p>Content information is sourced from TMDb. Video playback relies on external third-party services like VidSrc (for movies and TV shows).</p>
                <p>Contact us at: <a href="mailto:support@streamx.com" target="_blank" rel="noopener noreferrer">support@streamx.com</a></p>
            `;
        }

        // --- Authentication Functions ---
        function showLoginForm() {
            if (isMaintenanceMode) return; // Do nothing if in maintenance
            clearMessages();
            content.innerHTML = `
                <h1>Login to StreamX</h1>
                <p style="text-align:center; color:#00ccff;">You have to join <a href="https://discord.gg/v9tS43Hamm" target="_blank" rel="noopener noreferrer">StreamX Discord</a> to get a login.</p>
                <div style="text-align:center">
                    <input id="emailInput" type="email" placeholder="Email" style="padding:10px; margin:5px;"><br>
                    <input id="passwordInput" type="password" placeholder="Password" style="padding:10px; margin:5px;"><br>
                    <button onclick="login()">Login</button>
                </div>
                <div id="authMsg" style="color:red; text-align:center; margin-top:10px;"></div>
            `;
        }

        function login() {
            if (isMaintenanceMode) return; // Do nothing if in maintenance
            const email = document.getElementById("emailInput").value;
            const pass = document.getElementById("passwordInput").value;

            auth.signInWithEmailAndPassword(email, pass)
                .then((userCredential) => {
                    const user = userCredential.user;
                    console.log("Logged in:", user.email);
                    sendWebhookLog("login_success", { email: user.email, uid: user.uid, tier: "N/A" }); // Tier info not available here
                    // Redirect or update UI
                    window.location.hash = '#home'; // Go to home after login
                })
                .catch((error) => {
                    const authMsg = document.getElementById("authMsg");
                    let errorMessage = "Login failed. Please check your credentials.";
                    if (error.code === 'auth/user-not-found' || error.code === 'auth/wrong-password') {
                        errorMessage = "Invalid email or password.";
                    } else if (error.code === 'auth/invalid-email') {
                        errorMessage = "Invalid email format.";
                    }
                    authMsg.textContent = errorMessage;
                    console.error("Login error:", error);
                    sendWebhookLog("login_failure", { email: email, error: error.message });
                });
        }

        function logout() {
            auth.signOut().then(() => {
                console.log("Logged out");
                sendWebhookLog("logout_success", { email: auth.currentUser?.email || "N/A" });
                window.location.hash = '#login'; // Go to login page after logout
            }).catch((error) => {
                console.error("Logout error:", error);
                sendWebhookLog("logout_failure", { email: auth.currentUser?.email || "N/A", error: error.message });
            });
        }

        auth.onAuthStateChanged(user => {
            const authBar = document.getElementById("authBar");
            const userEmailSpan = document.getElementById("userEmail");
            const userTierBadge = document.getElementById("userTierBadge");
            const navTabs = document.getElementById("navTabs");

            if (user && !isMaintenanceMode) {
                authBar.style.display = "block";
                userEmailSpan.textContent = user.email;
                // Fetch user tier from Firebase Realtime Database
                database.ref('users/' + user.uid).once('value', (snapshot) => {
                    const userData = snapshot.val();
                    const tier = userData && userData.tier ? userData.tier : 'Free';
                    userTierBadge.textContent = tier;
                    adBanner.style.display = (tier === 'Free') ? 'block' : 'none';
                    navTabs.style.display = "flex"; // Show nav tabs if logged in
                    sendWebhookLog("auth_state_change_logged_in", { email: user.email, uid: user.uid, tier: tier });
                }).catch(error => {
                    console.error("Error fetching user data:", error);
                    userTierBadge.textContent = 'Free'; // Default to Free on error
                    adBanner.style.display = 'block';
                    navTabs.style.display = "flex";
                    sendWebhookLog("auth_state_change_logged_in_error", { email: user.email, uid: user.uid, error: error.message });
                });
            } else {
                authBar.style.display = "none";
                adBanner.style.display = "none"; // Hide ad banner if logged out
                navTabs.style.display = "none"; // Hide nav tabs if logged out
                if (!isMaintenanceMode) {
                    window.location.hash = '#login'; // Redirect to login if not logged in and not in maintenance
                    sendWebhookLog("auth_state_change_logged_out");
                }
            }
        });

        // --- Navigation Hashing ---
        function handleHashChange() {
            if (isMaintenanceMode) {
                document.getElementById("maintenanceMessage").style.display = 'flex';
                return; // Do nothing else if in maintenance
            }

            const hash = window.location.hash;
            clearMessages(); // Clear messages on hash change

            // Hide the grand opening banner on other pages
            if (hash !== '#home' && grandOpeningBanner) {
                grandOpeningBanner.style.display = 'none';
            } else if (grandOpeningBanner) {
                grandOpeningBanner.style.display = 'block';
            }

            switch (hash) {
                case '#home':
                    displayMediaGrid(await fetchMediaData('movie'), 'movie', 'Popular Movies');
                    break;
                case '#action':
                    displayMediaGrid(await fetchMediaData('movie', '28'), 'movie', 'Action Movies');
                    break;
                case '#comedy':
                    displayMediaGrid(await fetchMediaData('movie', '35'), 'movie', 'Comedy Movies');
                    break;
                case '#horror':
                    displayMediaGrid(await fetchMediaData('movie', '27'), 'movie', 'Horror Movies');
                    break;
                case '#scifi':
                    displayMediaGrid(await fetchMediaData('movie', '878'), 'movie', 'Sci-Fi Movies');
                    break;
                case '#tvshows':
                    displayMediaGrid(await fetchMediaData('tv'), 'tv', 'Popular TV Shows');
                    break;
                case '#search':
                    showSearchContent();
                    break;
                case '#login':
                    showLoginForm();
                    break;
                default:
                    if (!auth.currentUser) {
                        showLoginForm();
                    } else {
                        window.location.hash = '#home'; // Default to home if logged in
                    }
                    break;
            }
        }

        // Add event listeners for navigation
        navTabs.querySelectorAll('a').forEach(link => {
            link.addEventListener('click', async (event) => {
                event.preventDefault(); // Prevent default anchor behavior
                if (isMaintenanceMode) return; // Do nothing if in maintenance

                const mediaType = link.dataset.mediaType;
                const genreId = link.dataset.genre;
                const targetHash = link.getAttribute('href');

                if (targetHash === '#search') {
                    showSearchContent();
                } else if (targetHash === '#home') {
                    await displayMediaGrid(await fetchMediaData('movie'), 'movie', 'Popular Movies');
                } else if (mediaType && genreId !== undefined) {
                    await displayMediaGrid(await fetchMediaData(mediaType, genreId), mediaType, `${link.textContent}`);
                }
                window.location.hash = targetHash; // Update hash after content is loaded
            });
        });

        // Listen for hash changes
        window.addEventListener('hashchange', handleHashChange);

        // Initial load
        handleHashChange();
    </script>
</body>
</html>
